<!doctype html>
<html>
<head>
    <title>Kanon</title>

    <script type="text/javascript" src="node_modules/vis/dist/vis.js"></script>
    <link href="node_modules/vis/dist/vis.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" type="text/css" href="src/css/style.css">

</head>
<body>

<script>
    var __$__ = {
        SummarizedViewColor: {
            AddNode: 'orange',
            AddEdge: 'orange',
            RemoveEdge: 'seagreen'
        }
    };
</script>
<script type="text/javascript" src="node_modules/ace-builds/src/ace.js"></script>
<script type="text/javascript" src="node_modules/esprima/dist/esprima.js"></script>
<script type="text/javascript" src="external/escodegen/escodegen.browser.js"></script>
<script type="text/javascript" src="src/js/toVisjs.js"></script>
<script type="text/javascript" src="src/js/traverse.js"></script>
<script type="text/javascript" src="src/js/store-positions.js"></script>
<script type="text/javascript" src="src/js/code-conversion.js"></script>
<script type="text/javascript" src="src/js/update.js"></script>
<script type="text/javascript" src="src/js/context.js"></script>
<script type="text/javascript" src="src/js/jump-to-const.js"></script>
<script type="text/javascript" src="src/js/probe.js"></script>
<script type="text/javascript" src="src/live-editor-js/ast-walker.js"></script>
<script type="text/javascript" src="src/live-editor-js/ast-builder.js"></script>
<script type="text/javascript" src="src/live-editor-js/ast-transforms.js"></script>

<div id="editor">
<script>
    __$__.editor = ace.edit("editor");
    if (window.localStorage["Kanon-Code"] && window.localStorage["Kanon-Code"].indexOf('__$__') === -1)
        __$__.editor.setValue(window.localStorage["Kanon-Code"]);
    else
        __$__.editor.setValue('');

    __$__.editor.getSession().setMode('ace/mode/javascript');
    __$__.editor.getSession().setUseWorker(false);
    __$__.editor.on('change', __$__.Update.PositionUpdate);
    __$__.editor.getSelection().on('changeCursor', __$__.Update.ContextUpdate);
</script>
</div>

<div id="mynetwork">
</div>
<div id='button'>
    <input type="button" value="Summarized" onclick="__$__.Context.SwitchViewMode(false); __$__.Update.ContextUpdate('changed');">
    <input type="button" value="Snapshot" onclick="__$__.Context.SwitchViewMode(true); __$__.Update.ContextUpdate('changed');">
</div>
<div id='viewmode'>
</div>
<div id='reset'>
    <input type="button" value="Redraw" onclick="__$__.network.redraw();">
</div>
<div id='console'>
</div>
<script type="text/javascript">
    __$__.container = document.getElementById('mynetwork');
    __$__.data = {nodes: new vis.DataSet({}), edges: new vis.DataSet({})};
    __$__.options = {
        autoResize: false,
        nodes: {color: 'skyblue'},
        edges: {arrows: 'to', color: 'skyblue', width: 3},
        interaction: {zoomView: false},
    };
    __$__.network = new vis.Network(__$__.container, __$__.data, __$__.options);
    __$__.StorePositions.oldNetworkNodesData = __$__.network.body.data.nodes._data;
    __$__.StorePositions.oldNetworkEdgesData = __$__.network.body.data.edges._data;

    __$__.Update.PositionUpdate();
    __$__.editor.getSelection().clearSelection();

    document.getElementById('viewmode').textContent = (__$__.Context.Snapshot) ? 'View Mode: Snapshot' : 'View Mode: Summarized';

    window.onresize = function() {
        __$__.network.redraw();
    };
</script>
</body>
</html>
